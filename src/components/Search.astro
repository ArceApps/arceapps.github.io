<div class="relative">
  <button
    id="search-button"
    class="w-10 h-10 rounded-full flex items-center justify-center text-on-surface-variant dark:text-dark-on-surface-variant hover:bg-surface-variant dark:hover:bg-gray-800 transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50"
    aria-label="Buscar"
    aria-expanded="false"
    aria-controls="search-modal"
  >
    <span class="material-icons text-xl">search</span>
  </button>

  <!-- Search Modal/Dropdown -->
  <div
    id="search-modal"
    class="hidden fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-start justify-center pt-20 px-4"
    role="dialog"
    aria-modal="true"
    aria-label="Búsqueda"
  >
    <div
      class="bg-surface dark:bg-dark-surface w-full max-w-2xl rounded-xl shadow-2xl overflow-hidden animate-fade-in-down border border-gray-200 dark:border-gray-700"
    >
      <div
        class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center gap-3 transition-colors focus-within:border-primary focus-within:ring-1 focus-within:ring-primary/20"
      >
        <span class="material-icons text-primary text-2xl" aria-hidden="true">search</span>
        <input
          type="text"
          id="search-input"
          class="w-full bg-transparent border-none text-lg text-on-surface dark:text-dark-on-surface focus:outline-none focus:ring-0 placeholder-gray-400 dark:placeholder-gray-500"
          placeholder="Buscar artículos, aplicaciones..."
          autocomplete="off"
          maxlength="100"
        />
        <div class="hidden md:flex items-center gap-1 pointer-events-none select-none">
          <kbd class="hidden md:inline-block px-1.5 py-0.5 text-xs font-mono font-medium text-gray-500 bg-gray-100 border border-gray-300 rounded dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400">ESC</kbd>
        </div>
        <button
          id="close-search"
          class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:outline-none rounded ml-2 transition-colors"
          aria-label="Cerrar búsqueda"
        >
          <span class="material-icons">close</span>
        </button>
      </div>

      <div id="search-results" class="max-h-[60vh] overflow-y-auto p-2 hidden">
        <!-- Results will be injected here -->
      </div>

      <div
        id="search-status"
        class="p-4 text-center text-gray-500 dark:text-gray-400 hidden"
      >
        Escribe para buscar...
      </div>
    </div>
  </div>
</div>

<script src="../scripts/search.ts"></script>

<style>
  @keyframes fade-in-down {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fade-in-down {
    animation: fade-in-down 0.2s ease-out;
  }
</style>
